{% extends "store_index/base.html" %}
{% load static %}
<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="icon" href="data:,">
        <title>
            {% block title %}
            Customize
        </title>
        <script type="text/javascript" src="{% static '/html2canvas.min.js' %}">
        </script>
        <script type="text/javascript" src="{% static '/scripts.js' %}"></script>
        <style>
        .drpspc {
            height: 50vh;
            width: 50vh;
        }
        .drop_shirt {
            height: 50vh;   
            width: 50vh;
            border: 1px solid black;
        }
        img {
            object-fit: contain;
        }
        </style>
        {% endblock %}
    </head>


    <body>
        {% block content %}

        <div class="container" style="overflow-x: scroll; max-height:30vh;">
            <div class="row d-flex justify-content-center">
                <div class="col-12">
                    <div class="d-inline-flex align-items-center justify-content-center">
                        <div class="design-container mx-2 d-inline-flex justify-content-center">
                            <div class="text-center">
                                <img id="img_dragg" name="drag_img" class="draggable img-fluid" width="150px" height="150px" src="{% static '/design_hotcicadasummer.png' %}" alt="Card image">
                                <pre>hot cicada summer</pre>
                            </div>
                        </div>
                         <div class="design-container mx-2 d-inline-flex justify-content-center">
                            <div class="text-center">
                                <img draggable="true" name="drag_img" class="img-fluid" width="150px" height="150px" src="{% static '/design_prettyandpowerful.png' %}" ondragstart="drag(event)" alt="Card image">
                                <pre>pretty and powerful</pre>
                            </div>
                        </div>
                        <div class="design-container mx-2 d-inline-flex justify-content-center">
                            <div class="text-center">
                                <img draggable="true" name="drag_img" class="img-fluid" width="150px" height="150px" src="{% static '/design_onlyinnorthside.png' %}" ondragstart="drag(event)" alt="Card image">
                                <pre>only in northside</pre>
                            </div>
                        </div>
                        <div class="design-container mx-2 d-inline-flex justify-content-center">
                            <div class="text-center">
                                <img draggable="true" name="drag_img" class="img-fluid" width="150px" height="150px" src="{% static '/design_ididntask.png' %}" ondragstart="drag(event)" alt="Card image">
                                <pre>i didn't ask</pre>
                            </div>
                        </div>
                        <div class="design-container mx-2 d-inline-flex justify-content-center">
                            <div class="text-center">
                                <img draggable="true" name="drag_img" class="img-fluid" width="150px" height="150px" src="{% static '/design_hotcicadasummer.png' %}" ondragstart="drag(event)" alt="Card image">
                                <pre>hot cicada summer</pre>
                            </div>
                        </div>
                         <div class="design-container mx-2 d-inline-flex justify-content-center">
                            <div class="text-center">
                                <img draggable="true" name="drag_img" class="img-fluid" width="150px" height="150px" src="{% static '/design_prettyandpowerful.png' %}" ondragstart="drag(event)" alt="Card image">
                                <pre>pretty and powerful</pre>
                            </div>
                        </div>
                        <div class="design-container mx-2 d-inline-flex justify-content-center">
                            <div class="text-center">
                                <img draggable="true" name="drag_img" class="img-fluid" width="150px" height="150px" src="{% static '/design_onlyinnorthside.png' %}" ondragstart="drag(event)" alt="Card image">
                                <pre>only in northside</pre>
                            </div>
                        </div>
                        <div class="design-container mx-2 d-inline-flex justify-content-center">
                            <div class="text-center">
                                <img draggable="true" name="drag_img" class="img-fluid" width="150px" height="150px" src="{% static '/design_ididntask.png' %}" ondragstart="drag(event)" alt="Card image">
                                <pre>i didn't ask</pre>
                            </div>
                        </div>
                        <div class="design-container mx-2 d-inline-flex justify-content-center">
                            <div class="text-center">
                                <img draggable="true" name="drag_img" class="img-fluid" width="150px" height="150px" src="{% static '/design_hotcicadasummer.png' %}" ondragstart="drag(event)" alt="Card image">
                                <pre>hot cicada summer</pre>
                            </div>
                        </div>
                         <div class="design-container mx-2 d-inline-flex justify-content-center">
                            <div class="text-center">
                                <img draggable="true" name="drag_img" class="img-fluid" width="150px" height="150px" src="{% static '/design_prettyandpowerful.png' %}" ondragstart="drag(event)" alt="Card image">
                                <pre>pretty and powerful</pre>
                            </div>
                        </div>
                        <div class="design-container mx-2 d-inline-flex justify-content-center">
                            <div class="text-center">
                                <img draggable="true" name="drag_img" class="img-fluid" width="150px" height="150px" src="{% static '/design_onlyinnorthside.png' %}" ondragstart="drag(event)" alt="Card image">
                                <pre>only in northside</pre>
                            </div>
                        </div>
                        <div class="design-container mx-2 d-inline-flex justify-content-center">
                            <div class="text-center">
                                <img draggable="true" name="drag_img" class="img-fluid" width="150px" height="150px" src="{% static '/design_ididntask.png' %}" ondragstart="drag(event)" alt="Card image">
                                <pre>i didn't ask</pre>
                            </div>
                        </div>
                        <div class="design-container mx-2 d-inline-flex justify-content-center">
                            <div class="text-center">
                                <img draggable="true" name="drag_img" class="img-fluid" width="150px" height="150px" src="{% static '/design_hotcicadasummer.png' %}" ondragstart="drag(event)" alt="Card image">
                                <pre>hot cicada summer</pre>
                            </div>
                        </div>
                         <div class="design-container mx-2 d-inline-flex justify-content-center">
                            <div class="text-center">
                                <img draggable="true" name="drag_img" class="img-fluid" width="150px" height="150px" src="{% static '/design_prettyandpowerful.png' %}" ondragstart="drag(event)" alt="Card image">
                                <pre>pretty and powerful</pre>
                            </div>
                        </div>
                        <div class="design-container mx-2 d-inline-flex justify-content-center">
                            <div class="text-center">
                                <img draggable="true" name="drag_img" class="img-fluid" width="150px" height="150px" src="{% static '/design_onlyinnorthside.png' %}" ondragstart="drag(event)" alt="Card image">
                                <pre>only in northside</pre>
                            </div>
                        </div>
                        <div class="design-container mx-2 d-inline-flex justify-content-center">
                            <div class="text-center">
                                <img draggable="true" name="drag_img" class="img-fluid" width="150px" height="150px" src="{% static '/design_ididntask.png' %}" ondragstart="drag(event)" alt="Card image">
                                <pre>i didn't ask</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    
        <div class="container d-flex flex-column">
            <div class="row">
                <div class="col-12 d-flex justify-content-center">
                    <div class="my-3 btn-group" role="group">
                        <button type="button" class="btn btn-dark">Shirt</button>
                        <button type="button" class="btn btn-dark">Mug</button>
                        <button type="button" class="btn btn-dark">Water Bottle</button>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12 d-flex justify-content-center">
                    <div id="section_to_capture" class="drpspc">
                        <div class="drop_shirt d-flex justify-content-center">
                            <img class="img-fluid h-100" src="{% static '/drop_shirt.png' %}">
                        </div>
                        <div class="d-none drop_mug d-flex justify-content-center">
                            <img class="img-fluid h-100" src="{% static '/drop_shirt.png' %}">
                        </div>
                    </div>
                </div>
            </div>
            <div class="row"> 
                {% csrf_token %}
                <button type="button" id="submit" class="btn btn-primary">Save Screenshot</button>
            </div>
        </div>

        <script>
            let isDragging = false;

            document.addEventListener('mousedown', function(event) {

            let dragElement = event.target.closest('.draggable');

            if (!dragElement) return;

            event.preventDefault();

            dragElement.ondragstart = function() {
                return false;
            };

            let coords, shiftX, shiftY;

            startDrag(dragElement, event.clientX, event.clientY);

            function onMouseUp(event) {
                finishDrag();
            };

            function onMouseMove(event) {
                moveAt(event.clientX, event.clientY);
            }

            // on drag start:
            //   remember the initial shift
            //   move the element position:fixed and a direct child of body
            function startDrag(element, clientX, clientY) {
                if(isDragging) {
                return;
                }

                isDragging = true;

                document.addEventListener('mousemove', onMouseMove);
                element.addEventListener('mouseup', onMouseUp);

                shiftX = clientX - element.getBoundingClientRect().left;
                shiftY = clientY - element.getBoundingClientRect().top;

                element.style.position = 'fixed';

                moveAt(clientX, clientY);
            };

            // switch to absolute coordinates at the end, to fix the element in the document
            function finishDrag() {
                if(!isDragging) {
                return;
                }

                isDragging = false;

                dragElement.style.top = parseInt(dragElement.style.top) + window.pageYOffset + 'px';
                dragElement.style.position = 'absolute';

                document.removeEventListener('mousemove', onMouseMove);
                dragElement.removeEventListener('mouseup', onMouseUp);
            }

            function moveAt(clientX, clientY) {
                // new window-relative coordinates
                let newX = clientX - shiftX;
                let newY = clientY - shiftY;

                // check if the new coordinates are below the bottom window edge
                let newBottom = newY + dragElement.offsetHeight; // new bottom

                // below the window? let's scroll the page
                if (newBottom > document.documentElement.clientHeight) {
                // window-relative coordinate of document end
                let docBottom = document.documentElement.getBoundingClientRect().bottom;

                // scroll the document down by 10px has a problem
                // it can scroll beyond the end of the document
                // Math.min(how much left to the end, 10)
                let scrollY = Math.min(docBottom - newBottom, 10);

                // calculations are imprecise, there may be rounding errors that lead to scrolling up
                // that should be impossible, fix that here
                if (scrollY < 0) scrollY = 0;

                window.scrollBy(0, scrollY);

                // a swift mouse move make put the cursor beyond the document end
                // if that happens -
                // limit the new Y by the maximally possible (right at the bottom of the document)
                newY = Math.min(newY, document.documentElement.clientHeight - dragElement.offsetHeight);
                }

                // check if the new coordinates are above the top window edge (similar logic)
                if (newY < 0) {
                // scroll up
                let scrollY = Math.min(-newY, 10);
                if (scrollY < 0) scrollY = 0; // check precision errors

                window.scrollBy(0, -scrollY);
                // a swift mouse move can put the cursor beyond the document start
                newY = Math.max(newY, 0); // newY may not be below 0
                }


                // limit the new X within the window boundaries
                // there's no scroll here so it's simple
                if (newX < 0) newX = 0;
                if (newX > document.documentElement.clientWidth - dragElement.offsetWidth) {
                newX = document.documentElement.clientWidth - dragElement.offsetWidth;
                }

                dragElement.style.left = newX + 'px';
                dragElement.style.top = newY + 'px';
            }

            });
        </script>

        {% endblock %}
    </body>
</html>